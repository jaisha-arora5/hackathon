<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Marauder’s Map</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>

  <!-- COVER PAGE -->
  <div class="cover-page" id="cover">
    <img src="Images/cover.png" class="bg" id="coverImage" alt="Marauder Map" />
    <div class="glow" id="glow"></div>

    <!-- Google Login Button -->
    <button id="googleBtn" class="g-signin-button">Sign in with Google</button>
  </div>

  <!-- HOME PAGE -->
  <div class="home-page" id="home">
    <h1>JIIT College Map</h1>

    <!-- Floating Menu -->
    <div class="menu-container">
      <button id="menuBtn">≡</button>
      <div class="menu-options" id="menuOptions">
        <button>Your Profile</button>
        <button>View Room</button>
        <button>Join Room</button>
        <button>Settings</button>
        <button>Logout</button>
      </div>
    </div>
  </div>

  <!-- Script -->
  <script>
    let tokenClient;

    window.onload = function () {
      tokenClient = google.accounts.oauth2.initTokenClient({
        client_id: '678440281179-jqiml6orsrn6beunlgbe0sgav3970v2r.apps.googleusercontent.com',
        scope: 'email profile openid',
        callback: (tokenResponse) => {
          fetch('https://www.googleapis.com/oauth2/v3/userinfo', {
            headers: {
              Authorization: `Bearer ${tokenResponse.access_token}`
            }
          })
            .then(res => res.json())
            .then(user => {
              showWelcome(user.name);
              triggerCoverTransition();
            });
        }
      });

      const googleBtn = document.getElementById('googleBtn');
      googleBtn?.addEventListener('click', () => {
        tokenClient.requestAccessToken();
      });

      // Menu Button logic
      const menuBtn = document.getElementById('menuBtn');
      const menuOptions = document.getElementById('menuOptions');
      menuBtn?.addEventListener('click', () => {
        const isOpen = menuOptions.style.display === 'flex';
        menuOptions.style.display = isOpen ? 'none' : 'flex';
        menuBtn.textContent = isOpen ? '≡' : '✕';
      });
    };

    // Show Welcome Message
    function showWelcome(name) {
      const welcomeMsg = document.createElement('div');
      welcomeMsg.textContent = `Welcome, ${name}!`;
      welcomeMsg.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: gold;
        color: black;
        padding: 12px 18px;
        border-radius: 12px;
        font-weight: bold;
        z-index: 10000;
      `;
      document.body.appendChild(welcomeMsg);
    }

    // Animation transition to home
    function triggerCoverTransition() {
      const cover = document.getElementById('cover');
      const coverImage = document.getElementById('coverImage');
      const home = document.getElementById('home');
      const glow = document.getElementById('glow');

      coverImage.classList.add('zoomed');
      setTimeout(() => glow.classList.add('active'), 1000);
      setTimeout(() => {
        cover.style.opacity = 0;
        home.style.display = 'flex';
        home.style.opacity = 1;
      }, 3000);
      setTimeout(() => cover.style.display = 'none', 4000);
    }
  </script>
</body>
</html>
